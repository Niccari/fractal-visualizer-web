var ce=Object.defineProperty;var ue=(h,e,t)=>e in h?ce(h,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[e]=t;var o=(h,e,t)=>ue(h,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();const de=[{kind:"koch_triangle_outer",complexity:4,center:{x:.2,y:.3},scale:{w:1,h:1},rotation:{angle:30,speed:1},mutation:{size:1,angle:1},randomizer:{size:{amplify:10,seed:-90129041},angle:{amplify:-2.4,seed:1124901342}},style:{type:"line",thickness:3},color:{type:"cool",alpha:.9,speed:1}},{kind:"koch_triangle_inner",complexity:5,center:{x:.5,y:1.2},scale:{w:.4,h:.4},rotation:{angle:30,speed:-.9},mutation:{size:-1,angle:1},randomizer:{size:{amplify:0,seed:90129041},angle:{amplify:0,seed:124818419}},style:{type:"line",thickness:10},color:{type:"warm",alpha:.9,speed:.5}},{kind:"binary_tree",complexity:8,center:{x:.5,y:1.9},scale:{w:.2,h:.2},rotation:{angle:10,speed:-.2},mutation:{size:1.1,angle:.88},randomizer:{size:{amplify:.5,seed:90129041},angle:{amplify:-.1,seed:124818419}},style:{type:"triangle",thickness:10},color:{type:"rainbow",alpha:.9,speed:.5}},{kind:"tri_cis",complexity:6,center:{x:.8,y:3.3},scale:{w:1,h:1},rotation:{angle:80,speed:0},mutation:{size:1.2,angle:1.7},randomizer:{size:{amplify:0,seed:90129041},angle:{amplify:0,seed:124818419}},style:{type:"line",thickness:3},color:{type:"heat",alpha:.9,speed:.5}},{kind:"starmine",complexity:10,center:{x:.2,y:4.2},scale:{w:3,h:3},rotation:{angle:20,speed:.5},style:{type:"triangle",thickness:3},color:{type:"warm",alpha:.9,speed:.5}},{kind:"starmine",complexity:8,center:{x:.4,y:4.3},scale:{w:2.5,h:2.5},rotation:{angle:20,speed:.5},style:{type:"triangle",thickness:3},color:{type:"forest",alpha:.9,speed:.5}},{kind:"starmine",complexity:8,center:{x:.6,y:4.4},scale:{w:2,h:2},rotation:{angle:20,speed:.5},style:{type:"triangle",thickness:3},color:{type:"cool",alpha:.9,speed:.5}},{kind:"starmine",complexity:6,center:{x:.8,y:4.5},scale:{w:1.5,h:1.5},rotation:{angle:20,speed:.5},style:{type:"triangle",thickness:3},color:{type:"monochrome",alpha:.9,speed:.5}},{kind:"sunrise",complexity:100,center:{x:.4,y:5.1},scale:{w:3,h:3},rotation:{angle:-20,speed:0},style:{type:"curve",thickness:4},color:{type:"heat",alpha:.9,speed:.5}},{kind:"fold_ccurve",complexity:9,center:{x:.4,y:6},scale:{w:.4,h:.4},rotation:{angle:30,speed:0},mutation:{size:1,angle:1.5},randomizer:{size:{amplify:3,seed:90129041},angle:{amplify:-.6,seed:124818419}},style:{type:"line",thickness:5},color:{type:"pastel",alpha:.6,speed:.5}},{kind:"random",complexity:100,center:{x:.7,y:8},scale:{w:30,h:30},rotation:{angle:30,speed:0},mutation:{size:1,angle:1.5},randomizer:{size:{amplify:.1,seed:90129041},angle:{amplify:.1,seed:124818419}},style:{type:"circles",thickness:1.2},color:{type:"cool",alpha:.1,speed:10}},{kind:"random",complexity:100,center:{x:.7,y:9.5},scale:{w:30,h:30},rotation:{angle:30,speed:0},mutation:{size:1,angle:1.5},randomizer:{size:{amplify:.1,seed:90129041},angle:{amplify:.1,seed:124818419}},style:{type:"circles",thickness:1.2},color:{type:"warm",alpha:.1,speed:10}},{kind:"fold_dragon",complexity:10,center:{x:.5,y:11.2},scale:{w:.7,h:1.2},rotation:{angle:90,speed:.02},mutation:{size:.6,angle:-3.4},randomizer:{size:{amplify:.5,seed:-90129041},angle:{amplify:.1,seed:124818419}},style:{type:"curve",thickness:5},color:{type:"rainbow",alpha:.4,speed:2}}],he={charts:de},x=h=>h*Math.PI/180,k={LINE:"line",TRIANGLE:"triangle",CIRCLES:"circles",CURVE:"curve"},p={CIRCLE:"start",STAR:"star",CLOVER:"clover",SUNRISE:"sunrise",RANDOM:"random",STARMINE:"starmine",KOCH_CURVE:"koch_curve",KOCH_TRIANGLE_INNER:"koch_triangle_inner",KOCH_TRIANGLE_OUTER:"koch_triangle_outer",FOLD_DRAGON:"fold_dragon",FOLD_CCURVE:"fold_ccurve",TRI_CIS:"tri_cis",TRI_TRANS:"tri_trans",BINARY_TREE:"binary_tree"},T={RAINBOW:"rainbow",WARM:"warm",FOREST:"forest",COOL:"cool",HEAT:"heat",MONOCHROME:"monochrome",PASTEL:"pastel"},b=class b{constructor(e){o(this,"config");o(this,"colorTable",[]);o(this,"alphaHex");o(this,"colors",[]);o(this,"prevStart",null);o(this,"gradientRainbows",[{position:0,red:255,green:0,blue:0},{position:43,red:255,green:255,blue:0},{position:85,red:0,green:255,blue:0},{position:128,red:0,green:255,blue:255},{position:171,red:0,green:0,blue:255},{position:223,red:255,green:0,blue:255},{position:255,red:255,green:0,blue:0}]);o(this,"gradientWarm",[{position:0,red:255,green:0,blue:0},{position:128,red:255,green:255,blue:0},{position:255,red:255,green:0,blue:0}]);o(this,"gradientForest",[{position:0,red:255,green:255,blue:0},{position:128,red:0,green:255,blue:0},{position:255,red:255,green:255,blue:0}]);o(this,"gradientCool",[{position:0,red:0,green:0,blue:255},{position:128,red:0,green:255,blue:255},{position:255,red:0,green:0,blue:255}]);o(this,"gradientHeat",[{position:0,red:255,green:255,blue:0},{position:43,red:255,green:0,blue:0},{position:85,red:0,green:0,blue:255},{position:128,red:0,green:0,blue:0},{position:171,red:0,green:0,blue:255},{position:223,red:255,green:0,blue:0},{position:255,red:255,green:255,blue:0}]);o(this,"gradientMonochrome",[{position:0,red:0,green:0,blue:0},{position:128,red:255,green:255,blue:255},{position:255,red:0,green:0,blue:0}]);o(this,"gradientPastel",[{position:0,red:255,green:154,blue:154},{position:85,red:255,green:255,blue:154},{position:170,red:154,green:255,blue:255},{position:255,red:255,green:154,blue:154}]);this.config=e,this.alphaHex=b.colorToHex(Math.floor(255*this.config.alpha));const t=(()=>{switch(e.type.toString()){case T.RAINBOW:return this.gradientRainbows;case T.WARM:return this.gradientWarm;case T.FOREST:return this.gradientForest;case T.COOL:return this.gradientCool;case T.HEAT:return this.gradientHeat;case T.MONOCHROME:return this.gradientMonochrome;case T.PASTEL:return this.gradientPastel;default:throw Error("Not Implemented")}})();let n=1,s=t[0],r=t[1];for(let i=0;i<256;i+=1){const a=(i-s.position)/(r.position-s.position),l=s.red+a*(r.red-s.red),u=s.green+a*(r.green-s.green),c=s.blue+a*(r.blue-s.blue);this.colorTable.push(`#${b.colorToHex(l)}${b.colorToHex(u)}${b.colorToHex(c)}${this.alphaHex}`),r.position===i&&(s=r,n+=1,r=t[n])}}get(e,t){let n;if(this.colors.length!==t||this.prevStart===null)this.colors=[],n=t;else{n=Math.abs(e-this.prevStart);for(let s=0;s<n;s++)this.colors.shift()}for(let s=0;s<n;s++){const r=(e+this.config.speed*s)%256;this.colors.push(this.colorTable[r])}return this.prevStart=e,this.colors}};o(b,"colorToHex",e=>{const t=Math.round(e).toString(16);return t.length===1?`0${t}`:t});let j=b;const S=(h,e,t)=>{const n=Math.sin(t),s=Math.cos(t);return{x:h.x+e.x*s-e.y*n,y:h.y+e.x*n+e.y*s}};class pe{constructor(e,t){o(this,"shaper");o(this,"config");o(this,"identity");this.shaper=e,this.config=t}reset(){const{shaper:e,config:t}=this,n=e.configureBasePoints(t);this.identity={basePoints:n,orders:e.configureOrders(t.complexity),config:t,colorGenerator:new j(t.color),timestamp:0,points:new Array(n.length)}}simulate(){const{identity:e}=this;if(!e)throw new Error("shape not reset");const{config:t,orders:n,timestamp:s,points:r}=e,{rotation:i,scale:a,center:l}=t;e.config.kind===p.RANDOM&&this.reset();const u=i.angle+i.speed*s,c=e.colorGenerator.get(s,e.basePoints.length);for(let d=0;d<e.basePoints.length;d++){const m=e.basePoints[d],C={x:m.x*a.w,y:m.y*a.h};r[d]=S(l,C,u)}return e.timestamp+=1,{points:r,style:t.style,colors:c,orders:n}}}class F{constructor(e){o(this,"x",123456789);o(this,"y",362436069);o(this,"z",521288629);o(this,"seed");o(this,"generate",()=>{const e=this.x^this.x<<11;return this.x=this.y,this.y=this.z,this.z=this.seed,this.seed=this.seed^this.seed>>>19^(e^e>>>8),this.seed/2**32});this.seed=e}}const ee={baseAmplitude:.1};class z{static pointCounts(e){return 2**(Math.max(Math.min(e,10),2)+1)}configureBasePoints(e){var i,a,l,u;const t=new F(((a=(i=e.randomizer)==null?void 0:i.size)==null?void 0:a.seed)||-1),n=new F(((u=(l=e.randomizer)==null?void 0:l.angle)==null?void 0:u.seed)||-1),s=[{x:0,y:-.1,index:0},{x:0,y:0,index:1}],r=this.divideBasePoints(e,s[0],s[1],1,.85,x(45),t,n);return[s[0],s[1],...r]}divideBasePoints(e,t,n,s,r,i,a,l){var M,N;const{complexity:u,randomizer:c,mutation:d}=e,m=(((M=c==null?void 0:c.size)==null?void 0:M.amplify)||0)*a.generate(),C=(((N=c==null?void 0:c.angle)==null?void 0:N.amplify)||0)*l.generate(),g=r*(m+((d==null?void 0:d.size)||1)),R=i*(C+((d==null?void 0:d.angle)||1));if(s>=Math.floor(z.pointCounts(u)/2))return[];const K={x:g*(n.x-t.x),y:g*(n.y-t.y)},V=2*s,y=2*s+1,E={...S(n,K,R),index:V},P={...S(n,K,-R),index:y},I=[];return I.push(...this.divideBasePoints(e,n,E,V,g,R,a,l)),I.push(...this.divideBasePoints(e,n,P,y,g,R,a,l)),[E,P,...I.sort((q,$)=>q.index-$.index)]}configureOrders(e){const t=z.pointCounts(e)/2;return[{link:[0,1]},...this.setOrdersRecursive(t,1).sort((n,s)=>n.link[1]-s.link[1])]}setOrdersRecursive(e,t){if(t>=e)return[];const n=2*t,s=2*t+1,r={link:[t,n]},i={link:[t,s]},a=this.setOrdersRecursive(e,n),l=this.setOrdersRecursive(e,s);return[r,i,...a,...l]}}const O=h=>Array.from({length:h},(e,t)=>t),w={LOOP:"loop",START_END_2X_FASTER:"start_end_2x_faster",END_2X_FASTER:"end_2x_faster",LINEAR:"linear"};class v{generate(e){const{type:t,pointCount:n}=e;switch(t){case w.LINEAR:return O(n-1).map(s=>({link:[s,(s+1)%n]}));case w.LOOP:return O(n).map(s=>({link:[s,(s+1)%n]}));case w.START_END_2X_FASTER:return O(n).map(s=>({link:[2*s%n,2*(s+1)%n]}));case w.END_2X_FASTER:return O(n).map(s=>({link:[s,2*(s+1)%n]}));default:return[]}}}const A={CIRCLE:"circle",RANDOM:"random"};class X{generate(e){const{type:t,length:n}=e,{baseAmplitude:s}=ee;switch(t){case A.CIRCLE:return O(n).map(i=>2*Math.PI*i/n).map(i=>({x:s*Math.sin(i),y:s*Math.cos(i)}));case A.RANDOM:return O(n).map(()=>({x:s*(Math.random()-.5),y:s*(Math.random()-.5)}));default:return[]}}}class D{static pointCounts(e){return e}configureBasePoints(e){const t=D.pointCounts(e.complexity);return new X().generate({type:A.CIRCLE,length:t})}configureOrders(e){const t=D.pointCounts(e);return new v().generate({type:w.LOOP,pointCount:t})}}class _{static pointCounts(e){return e*40}configureBasePoints(e){const t=_.pointCounts(e.complexity),{baseAmplitude:n}=ee;return O(t).map(s=>{const r=2*Math.PI*s/t,i=n*Math.sin(e.complexity*r);return{x:i*Math.cos(r-Math.PI),y:i*Math.sin(r-Math.PI)}})}configureOrders(e){const t=_.pointCounts(e);return new v().generate({type:w.LOOP,pointCount:t})}}class te{recursive(e,t,n,s,r,i,a,l){const{randomizer:u,mutation:c,complexity:d}=e,m=i[t%i.length],C={x:r.x-s.x,y:r.y-s.y},g=[];if(m.folds.forEach((y,E)=>{var oe,ie;const P=E===0||y.fromStart?s:y.fromEnd?r:g[E-1],I=y.fromEnd?-1:1,{length:M,radian:N}=y,q=(((oe=u==null?void 0:u.size)==null?void 0:oe.amplify)??0)*a.generate(),$=(((ie=u==null?void 0:u.angle)==null?void 0:ie.amplify)??0)*l.generate(),re=I*M*(q+((c==null?void 0:c.size)??1)),ae=N*($+((c==null?void 0:c.angle)??1)),le={x:C.x*re,y:C.y*re};g.push(S(P,le,ae))}),n===d)return t===0?[s,...g,r]:t<m.folds.length-1?[...g,r]:[...g,r];const R=[s,...g,r];return[...Array.from({length:R.length-1},(y,E)=>E).map(y=>[R[y],R[y+1]]).map((y,E)=>{const P=(m.folds.length+1)*t+E;return[...this.recursive(e,P,n+1,y[0],y[1],i,a,l)]}).reduce((y,E)=>y.concat(E))]}createPoints(e,t){var l,u,c,d;const n=new F(((u=(l=e.randomizer)==null?void 0:l.size)==null?void 0:u.seed)||-1),s=new F(((d=(c=e.randomizer)==null?void 0:c.angle)==null?void 0:d.seed)||-1),r={x:-.1,y:0},i={x:.1,y:0};return this.recursive(e,0,2,r,i,t,n,s)}}class ne{constructor(){o(this,"engine");this.engine=new te}static selectFoldRules(e){const t={length:Math.SQRT1_2,radian:x(45)},n={length:Math.SQRT1_2,radian:x(-45)};switch(e){case p.FOLD_CCURVE:return[{folds:[n]}];case p.FOLD_DRAGON:return[{folds:[t]},{folds:[n]}];default:throw new Error("Unsupported curve type!")}}configureBasePoints(e){const t=ne.selectFoldRules(e.kind);return this.engine.createPoints(e,t)}configureOrders(e){const t=2**(e-1)+1;return new v().generate({type:w.LINEAR,pointCount:t})}}class Y{static pointCounts(e){return e}configureBasePoints(e){const t=Y.pointCounts(e.complexity);return new X().generate({type:A.RANDOM,length:t})}configureOrders(e){const t=Y.pointCounts(e);return new v().generate({type:w.LOOP,pointCount:t})}}class H{static pointCounts(e){return e}configureBasePoints(e){const t=H.pointCounts(e.complexity);return new X().generate({type:A.CIRCLE,length:t})}configureOrders(e){const t=H.pointCounts(e);return new v().generate({type:w.START_END_2X_FASTER,pointCount:t})}}class B{static pointCounts(e){return e*2}configureBasePoints(e){const t=B.pointCounts(e.complexity),{baseAmplitude:n}=ee;return O(t).map(s=>{const r=2*Math.PI*s/t-Math.PI,i=s%2===0?n:n/4;return{x:i*Math.cos(r),y:i*Math.sin(r)}})}configureOrders(e){return new v().generate({type:w.LOOP,pointCount:B.pointCounts(e)})}}class U{static pointCounts(e){return e}configureBasePoints(e){return new X().generate({type:A.CIRCLE,length:U.pointCounts(e.complexity)})}configureOrders(e){return new v().generate({type:w.END_2X_FASTER,pointCount:U.pointCounts(e)})}}class W{constructor(){o(this,"engine");this.engine=new te}static getFoldRule(){return[{folds:[{length:1/3,radian:0},{length:1/3,radian:x(60)},{length:1/3,radian:x(-60)}]}]}configureBasePoints(e){const t=W.getFoldRule();return this.engine.createPoints(e,t)}configureOrders(e){const t=2**(2*(e-1))+1;return new v().generate({type:w.LINEAR,pointCount:t})}}class se{constructor(){o(this,"engine");this.engine=new te}static selectFoldRules(e){const t=[{folds:[{length:.5,radian:x(90)},{length:.5,radian:0,fromStart:!0},{length:.5,radian:x(90),fromEnd:!0}]}],n=[{folds:[{length:1/2,radian:x(90)},{length:1/2,radian:0,fromStart:!0},{length:1/2,radian:x(-90),fromEnd:!0}]}];return e===p.TRI_CIS?n:t}configureBasePoints(e){const t=se.selectFoldRules(e.kind);return this.engine.createPoints(e,t)}configureOrders(e){const t=2**(2*(e-1))+1;return new v().generate({type:w.LINEAR,pointCount:t})}}class ge{constructor(){o(this,"kochCurve");this.kochCurve=new W}configureBasePoints(e){const t=e.kind===p.KOCH_TRIANGLE_INNER;let n=this.kochCurve.configureBasePoints(e);const s=x(120);t&&(n=n.map(a=>({...a,y:-a.y}))),n=n.map(a=>({...a,y:a.y+.1/Math.sqrt(3)}));const r=n.map(a=>S({x:0,y:0},a,s)),i=r.map(a=>S({x:0,y:0},a,s));return[...n,...i,...r]}configureOrders(e){const t=3*(2**(2*(e-1))+1);return new v().generate({type:w.LINEAR,pointCount:t})}}const G=class G{constructor(){o(this,"load",()=>{const t=he.charts.map(n=>{const s={...n,kind:n.kind,style:{...n.style,type:n.style.type},color:{...n.color,type:n.color.type},rotation:{angle:x(n.rotation.angle),speed:x(n.rotation.speed)},complexity:n.complexity};return{chart:G.instantiateChart(s.kind),config:s}}).map(n=>new pe(n.chart,n.config));return t.map(n=>n.reset()),t})}};o(G,"instantiateChart",e=>{switch(e){case p.STAR:return new H;case p.STARMINE:return new B;case p.SUNRISE:return new U;case p.CIRCLE:return new D;case p.CLOVER:return new _;case p.RANDOM:return new Y;case p.FOLD_CCURVE:case p.FOLD_DRAGON:return new ne;case p.KOCH_CURVE:return new W;case p.KOCH_TRIANGLE_INNER:case p.KOCH_TRIANGLE_OUTER:return new ge;case p.TRI_CIS:case p.TRI_TRANS:return new se;case p.BINARY_TREE:return new z;default:throw new Error("Unsupported chart type!")}});let Q=G;class ye{constructor(e){o(this,"visualizer");o(this,"simulators");o(this,"scrollEndCount");o(this,"touchScrollPrevY");o(this,"scrollY");o(this,"animationId");o(this,"lastFrameTime",0);o(this,"targetFrameRate",60);o(this,"isVisible",!0);o(this,"isPaused",!1);o(this,"start",(e=60)=>{this.targetFrameRate=e,this.animate()});o(this,"animate",(e=performance.now())=>{if(!this.isVisible||this.isPaused){this.animationId=requestAnimationFrame(this.animate);return}const t=e-this.lastFrameTime,n=1e3/this.targetFrameRate;if(t>=n){const s=this.simulate();this.visualizer.draw(s),this.lastFrameTime=e}this.animationId=requestAnimationFrame(this.animate)});o(this,"stop",()=>{this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=void 0)});o(this,"pause",()=>{this.isPaused=!0});o(this,"resume",()=>{this.isPaused=!1,this.animationId||this.animate()});o(this,"handleVisibilityChange",()=>{this.isVisible=!document.hidden,this.isVisible&&!this.animationId&&this.animate()});o(this,"restrictScroll",()=>{this.scrollY<0&&(this.scrollY=0),this.scrollY>3400&&(this.scrollY=3400)});o(this,"handleScroll",e=>{this.scrollY+=e,this.restrictScroll(),this.scrollEndCount=6});o(this,"handleTouchScroll",e=>{this.touchScrollPrevY&&(this.scrollY-=2*(e-this.touchScrollPrevY)),this.touchScrollPrevY=e,this.restrictScroll(),this.scrollEndCount=6});o(this,"simulate",()=>{if(this.scrollEndCount-=1,this.scrollEndCount===0){this.touchScrollPrevY=void 0;const n=`${window.location.pathname}?depth=${this.scrollY}`;window.history.replaceState(null,"Fractal-Visualizer depth: + scrollY",n)}const e=this.simulators.map(n=>n.simulate()),t=this.scrollY/300;for(const n of e)for(const s of n.points)s.y-=t;return e});this.visualizer=e,this.simulators=new Q().load(),this.scrollEndCount=0,this.scrollY=(()=>{const t=new URL(document.location.href).searchParams;return Number.parseInt(t.get("depth")||"0",10)})(),document.addEventListener("visibilitychange",this.handleVisibilityChange)}}const f=class f{constructor(){o(this,"nullableContext",null);o(this,"setContext",e=>{this.nullableContext=e;const t=e.canvas.width,n=e.canvas.height;e.fillStyle="rgb(0, 0, 0)",e.fillRect(0,0,t,n)});o(this,"draw",e=>{const t=this.nullableContext;if(t!==null){const n=t.canvas.width,s=t.canvas.height;t.fillStyle="rgba(0, 0, 0, 0.05)",t.fillRect(0,0,n,s);for(const r of e)f.shouldDrawChart(r.points)&&f.drawChart(t,r,n,s)}})}};o(f,"drawLine",(e,t,n,s,r)=>{e.lineWidth=s,e.strokeStyle=r,e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(n.x,n.y),e.closePath(),e.stroke()}),o(f,"drawTriangle",(e,t,n,s,r)=>{const i=n.x-t.x,a=n.y-t.y,l=Math.sqrt(i*i+a*a),u=i/l,c=a/l;e.fillStyle=r,e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(t.x+c*s,t.y-u*s),e.lineTo(t.x-c*s,t.y+u*s),e.lineTo(n.x,n.y),e.closePath(),e.fill()}),o(f,"drawCircles",(e,t,n,s,r)=>{const i=Math.log(s||11),a=n.x-t.x,l=n.y-t.y,u=Math.sqrt(a*a+l*l),c=i*u,d=2*Math.PI;e.fillStyle=r,e.beginPath(),e.arc(t.x+a*.3,t.y+l*.3,c*.3,0,d),e.fill(),e.beginPath(),e.arc(t.x+a*.6,t.y+l*.6,c*.15,0,d),e.fill()}),o(f,"drawCurve",(e,t,n,s,r)=>{const i=1.5*(s||1),a=n.x-t.x,l=n.y-t.y,u=Math.sqrt(a*a+l*l),c=a/u,d=l/u,m=t.x+(n.x-t.x)/2,C=t.y+(n.y-t.y)/2,g=d*i,R=c*i;e.fillStyle=r,e.beginPath(),e.moveTo(t.x,t.y),e.bezierCurveTo(m+1.5*g,C-1.5*R,m+1.5*g,C-1.5*R,n.x,n.y),e.bezierCurveTo(m+2*g,C-2*R,m+2*g,C-2*R,t.x,t.y),e.closePath(),e.fill()}),o(f,"shouldDrawChart",e=>{const t=e.map(r=>r.y),n=Math.min(...t);return Math.max(...t)>-1&&n<1}),o(f,"drawChart",(e,t,n,s)=>{const r=t.points.map(l=>({x:l.x*n,y:l.y*s})),{style:i}=t,a=(()=>{switch(i.type){case k.LINE:return f.drawLine;case k.TRIANGLE:return f.drawTriangle;case k.CIRCLES:return f.drawCircles;case k.CURVE:return f.drawCurve;default:throw new Error("Invalid style type!")}})();for(let l=0;l<t.orders.length;l+=1){const u=t.orders[l],{link:c}=u,d=t.colors[l],m=r[c[0]],C=r[c[1]];a(e,m,C,i.thickness,d)}});let J=f;const L=class L{constructor(e){const t=document.getElementById("canvas");if(t instanceof HTMLCanvasElement){if("ontouchstart"in window){const s=i=>{i.preventDefault()},r=i=>{i.preventDefault(),e.onTouchScroll(i.touches[0].pageY)};t.addEventListener("touchstart",s,{passive:!1}),t.addEventListener("touchend",s,{passive:!1}),t.addEventListener("touchcancel",s,{passive:!1}),t.addEventListener("touchmove",r,{passive:!1})}else t.onwheel=s=>{e.onScroll(s.deltaY)};window.onresize=()=>{L.adjustCanvas(t)};const n=t.getContext("2d");n instanceof CanvasRenderingContext2D&&(L.adjustCanvas(t),e.onCanvasReady(n))}}};o(L,"adjustCanvas",e=>{const t=window.devicePixelRatio;e.width=window.innerWidth*t*2,e.height=window.innerHeight*t*2});let Z=L;class me{constructor(e,t){o(this,"visualizer");o(this,"simulator");o(this,"onCanvasReady",e=>{this.visualizer.setContext(e),this.simulator.start(50)});o(this,"onScroll",e=>{this.simulator.handleScroll(e)});o(this,"onTouchScroll",e=>{this.simulator.handleTouchScroll(e)});this.visualizer=e,this.simulator=t}}class fe{constructor(){const e=new J,t=new ye(e),n=new me(e,t);new Z(n)}}new fe;
